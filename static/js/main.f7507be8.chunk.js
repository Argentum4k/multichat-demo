(this["webpackJsonpmultichat-demo"]=this["webpackJsonpmultichat-demo"]||[]).push([[0],{119:function(e,t,s){"use strict";s.r(t);var n=s(0),c=s.n(n),a=s(19),o=s.n(a),i=(s(78),s(79),s(23)),r=s(64),l=s(12),u=s(10),d=s(58),m=s.n(d)()("http://localhost:4000",{autoConnect:!1}),j=function(){var e,t,s=Object(n.useState)(),c=Object(u.a)(s,2),a=c[0],o=c[1],d=Object(n.useState)(),j=Object(u.a)(d,2),b=j[0],h=j[1],O=Object(n.useState)(),v=Object(u.a)(O,2),g=v[0],f=v[1],p=Object(n.useState)({}),x=Object(u.a)(p,2),N=x[0],_=x[1],y=Object(n.useState)(),I=Object(u.a)(y,2),C=I[0],S=I[1],k=Object(n.useState)(),R=Object(u.a)(k,2),T=R[0],w=R[1];Object(n.useEffect)((function(){var s=sessionStorage.getItem("sessionId");return s&&(m.auth={sessionId:s},m.connect(),console.log("Trying to reconnect with sessionId")),m.on("connect",(function(){console.log("Connected to server successfully"),s||m.emit("user",{username:e,avatar:t}),m.emit("setUpUser")})),m.on("session",(function(e){var t=e.sessionId,s=e.userId;m.auth={sessionId:t},sessionStorage.setItem("sessionId",t),m.userId=s})),m.on("user",(function(e){o(e)})),m.on("users",(function(e){h(e)})),m.on("rooms",(function(e){f(e)})),m.on("room",(function(e){o((function(t){return Object(l.a)(Object(l.a)({},t),{},{roomId:e})}))})),m.on("chat",(function(e){_((function(t){var s,n;return Object(l.a)(Object(l.a)({},t),{},Object(i.a)({},e.room,{messages:[].concat(Object(r.a)((null===(s=t[e.room])||void 0===s?void 0:s.messages)||[]),[e]),unread:((null===(n=t[e.room])||void 0===n?void 0:n.unread)||0)+("message"===e.type?1:0)}))}))})),m.on("typing",(function(e){S(e)})),m.on("stoppedTyping",(function(){S(null)})),function(){console.log("Disconnected from server"),m.disconnect()}}),[]);return{socket:m,user:a,users:b,chat:N,setChat:_,rooms:g,logIn:function(s){var n=s.username,c=s.avatar;e=n,t=c,m.auth={username:n},m.connect()},logOut:function(){o(null),sessionStorage.removeItem("sessionId"),m.disconnect(),console.log("User logged out")},sendMessage:function(e){m.emit("message",e)},createRoom:function(e){console.log("emit createRoom"),m.emit("createRoom",e)},updateRoom:function(e){m.emit("updateRoom",e),_((function(t){var s;return Object(l.a)(Object(l.a)({},t),{},(s={},Object(i.a)(s,a.roomId,Object(l.a)(Object(l.a)({},t[a.roomId]),{},{unread:0})),Object(i.a)(s,e,Object(l.a)(Object(l.a)({},t[e]),{},{unread:0})),s))}))},deleteRoom:function(e){m.emit("deleteRoom",e)},typing:function(){m.emit("typing"),clearTimeout(T),w(null)},stoppedTyping:function(){null==T&&w(setTimeout((function(){m.emit("stoppedTyping")}),300))},userTyping:C,logStates:function(e){var t=e.showUser,s=void 0!==t&&t,n=e.showUsers,c=void 0!==n&&n,o=e.showRooms,i=void 0!==o&&o,r=e.showChat,l=void 0!==r&&r;s&&console.log(a),c&&console.log(b),i&&console.log(g),l&&console.log(N)}}},b=s(136),h=s(2),O={borderRadius:10,padding:"1em",boxShadow:"0px 10px 10px rgba(113, 113, 113, 0.1)",border:0},v=function(e){var t=e.roomId,s=e.rooms,c=Object(n.useState)([]),a=Object(u.a)(c,2),o=a[0],i=a[1];return Object(n.useEffect)((function(){var e,n=null===s||void 0===s||null===(e=s.filter((function(e){return e.id===t}))[0])||void 0===e?void 0:e.members;i(n)}),[t,s]),Object(h.jsxs)(b.a,{trigger:Object(h.jsx)("div",{className:"chat_info",children:"i"}),style:O,children:[Object(h.jsxs)("p",{style:{fontWeight:"600"},children:["Users: ",Object(h.jsx)("span",{style:{color:"#1ecdc5"},children:null===o||void 0===o?void 0:o.length})]}),Object(h.jsx)("p",{children:null===o||void 0===o?void 0:o.join(", ")})]})},g=(s(116),s(63)),f=function(e){var t,s,c=e.client,a=c.user,o=c.logOut,i=c.users,r=c.chat,l=c.rooms,d=c.createRoom,m=c.updateRoom,j=c.deleteRoom,b=c.sendMessage,O=c.typing,f=c.userTyping,p=c.stoppedTyping,x=Object(n.useState)(""),N=Object(u.a)(x,2),_=N[0],y=N[1],I=Object(n.useState)(""),C=Object(u.a)(I,2),S=C[0],k=C[1],R=Object(n.useState)(!1),T=Object(u.a)(R,2),w=T[0],E=T[1],U=Object(n.useRef)(null),K=Object(n.useRef)(),M=function(){var e;null===(e=U.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};Object(n.useEffect)((function(){M()}),[]),Object(n.useEffect)((function(){M()}),[r,a.roomId]);return Object(h.jsxs)("div",{className:"chat_app",onClick:function(e){return function(e){w&&!K.current.contains(e.target)&&E(!1)}(e)},children:[Object(h.jsxs)("div",{className:"left_sidebar",children:[Object(h.jsxs)("div",{className:"logo_text",children:[Object(h.jsx)("span",{children:"Chit"})," ",Object(h.jsx)("span",{className:"colored",children:"Chat"})]}),Object(h.jsxs)("div",{className:"profile_info",children:[Object(h.jsx)("img",{src:a.avatar,className:"avatar_profile",alt:""}),Object(h.jsx)("span",{children:a.username}),Object(h.jsx)("p",{onClick:function(){return o()},children:"Logout"})]}),Object(h.jsx)("span",{style:{alignSelf:"flex-start",fontWeight:"600"},children:"Users"}),Object(h.jsx)("div",{className:"active_users_list",children:(null===i||void 0===i?void 0:i.length)>1?null===i||void 0===i?void 0:i.map((function(e){return e.userId!==a.userId?Object(h.jsxs)("div",{className:"user_card",children:[Object(h.jsx)("img",{src:e.avatar,className:"small_img",alt:""}),Object(h.jsx)("span",{children:e.username})]},e.userId):null})):Object(h.jsx)("div",{className:"announcement",children:Object(h.jsx)("span",{children:"No users online"})})})]}),Object(h.jsx)("div",{className:"chat_area",children:Object(h.jsxs)("div",{className:"chat_bg",children:[Object(h.jsx)(v,{roomId:a.roomId,rooms:l}),Object(h.jsxs)("div",{className:"chat",children:[r&&(null===(t=r[a.roomId])||void 0===t||null===(s=t.messages)||void 0===s?void 0:s.map((function(e,t){return"info"===e.type?Object(h.jsx)("div",{className:"announcement",children:Object(h.jsx)("span",{children:e.content})},t):Object(h.jsxs)("div",{className:e.userId===a.userId?"message_holder me":"message_holder",children:[Object(h.jsx)("img",{src:e.avatar,className:"small_img",alt:""}),Object(h.jsx)("div",{className:"message_box",children:Object(h.jsxs)("div",{className:"message",children:[Object(h.jsx)("span",{className:"message_name",children:e.username}),Object(h.jsx)("span",{className:"message_text",children:e.content})]})})]},t)}))),Object(h.jsx)("div",{ref:U})]}),Object(h.jsx)("div",{style:{marginLeft:15,color:"#f48235"},children:Object(h.jsx)("i",{children:f&&f!==a.username&&"Typing ".concat(f)})}),Object(h.jsxs)("div",{className:"chat_input",style:{position:"relative"},children:[w&&Object(h.jsx)("span",{ref:function(e){return K.current=e},onKeyUp:function(e){return function(e){13===e.keyCode&&(b(S),k(""),E(!1))}(e)},style:{position:"absolute",bottom:60,left:0},children:Object(h.jsx)(g.a,{onSelect:function(e){var t=e.native;k((function(e){return e+t}))},emojiSize:20})}),Object(h.jsx)("i",{className:"far fa-smile-wink",style:{marginRight:8,color:"grey"},onClick:function(){return E((function(e){return!e}))}}),Object(h.jsx)("input",{type:"text",value:S,placeholder:"Enter message",onChange:function(e){k(e.target.value),O()},onKeyUp:function(e){!function(e,t){13===e.keyCode&&(b(t),k(""),E(!1))}(e,S),p()}}),Object(h.jsx)("button",{className:"send_message_btn",onClick:function(e){b(S),k("")},children:"SEND"})]})]})}),Object(h.jsxs)("div",{className:"right_sidebar",children:[Object(h.jsx)("span",{style:{alignSelf:"flex-start",fontWeight:"600"},children:"Rooms"}),Object(h.jsx)("div",{className:"active_rooms_list",children:null===l||void 0===l?void 0:l.map((function(e){var t,s;return Object(h.jsxs)("div",{className:e.id===a.roomId?"room_card active_item":"room_card",onClick:function(){return m(e.id)},children:[Object(h.jsxs)("div",{className:"room_item_content",children:[Object(h.jsx)("img",{src:e.avatar,className:"small_img",alt:""}),Object(h.jsxs)("div",{className:"roomInfo",children:[Object(h.jsx)("span",{children:e.name}),Object(h.jsx)("span",{className:"room_author",children:e.username})]})]}),Object(h.jsxs)("div",{className:"room_item_controls",children:[e.userId===a.userId&&Object(h.jsx)("div",{onClick:function(){return j(e.id)},style:{margin:3},children:Object(h.jsx)("i",{className:"far fa-trash-alt",style:{color:"grey"}})}),(null===(t=r[e.id])||void 0===t?void 0:t.unread)>0&&e.id!==a.roomId&&Object(h.jsx)("div",{className:"badge",children:null===(s=r[e.id])||void 0===s?void 0:s.unread})]})]},e.id)}))}),Object(h.jsxs)("div",{className:"room_input",children:[Object(h.jsx)("input",{type:"text",value:_,placeholder:"Create room",onChange:function(e){return y(e.target.value)},onKeyUp:function(e){return function(e){13===e.keyCode&&(d(e.target.value),y(""))}(e)}}),Object(h.jsx)("span",{className:"room_add_icon_holder",onClick:function(){d(_),y("")},children:"+"})]})]})]})},p=["https://semantic-ui.com/images/avatar2/small/patrick.png","https://semantic-ui.com/images/avatar2/small/kristy.png","https://semantic-ui.com/images/avatar2/small/mark.png","https://semantic-ui.com/images/avatar2/small/matthew.png","https://semantic-ui.com/images/avatar2/small/elyse.png","https://semantic-ui.com/images/avatar2/small/lindsay.png"];var x=function(e){var t=e.logIn,s=Object(n.useState)(""),c=Object(u.a)(s,2),a=c[0],o=c[1],i=Object(n.useState)("https://semantic-ui.com/images/avatar2/small/patrick.png"),r=Object(u.a)(i,2),l=r[0],d=r[1];return Object(h.jsxs)("div",{className:"chat_login",children:[Object(h.jsxs)("div",{className:"logo_text",children:[Object(h.jsx)("span",{children:"Chit"})," ",Object(h.jsx)("span",{className:"colored",children:"Chat"})]}),Object(h.jsx)("div",{className:"avatar_list",children:p.map((function(e,t){return Object(h.jsx)("div",{className:l===e?"avatar active_avatar":"avatar",children:Object(h.jsx)("img",{src:e,className:"avatar_image",alt:"",onClick:function(){return d(e)}})},t)}))}),Object(h.jsx)("div",{className:"username_input_holder",children:Object(h.jsx)("input",{type:"text",value:a,placeholder:"Enter Name",className:"username_input",onChange:function(e){return o(e.target.value)}})}),Object(h.jsx)("div",{className:"btn_holder",children:Object(h.jsx)("button",{className:"enter_chat_btn",onClick:function(){return t({username:a,avatar:l})},children:"ENTER CHAT"})})]})},N=function(){var e=j();return Object(h.jsx)("div",{className:"app",children:e.user?Object(h.jsx)(f,{client:e}):Object(h.jsx)(x,{logIn:e.logIn})})};s(118);o.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(N,{})}),document.getElementById("root"))},78:function(e,t,s){},79:function(e,t,s){}},[[119,1,2]]]);
//# sourceMappingURL=main.f7507be8.chunk.js.map